<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEMO</title>
    <style>
        * {
            padding: 0;
            margin: 0;
            user-select: none;
        }

        .container {
            background-color: #fafafa;
            border: 1px solid #ccc;
            position: relative;
        }

        .down {
            display: flex;
            margin-top: 20px;
        }

        #container {
            width: 100%;
            height: 500px;
            position: relative;
            overflow: hidden;
        }

        #leak {
            position: absolute;
            left: 0;
            opacity: 0;
            top: 100px;
            width: 100%;
            box-sizing: border-box;
            padding: 4px;
            border-top: 1px dashed #000;
            pointer-events: none;
            transition: opacity 0.75s ease-in-out;
        }

        #leak>span {
            color: #000;
        }
    </style>
</head>

<body>

    <div class="container" id="container">
        <div id="leak">
            <span>泄漏区</span>
        </div>
    </div>

    <button id="btn-prev">prev</button>
    <button id="btn-next">next</button>
    <button id="resize">resize</button>
    <button id="relayout">relayout</button>
    <button id="switch-mode">switch mode</button>
    <button id="brush-select">brush-select</button>
    <span id="pos"></span>

    <script src="./../dist/sv.js"></script>
    <script>

        const Group = SV.Group,
            Bound = SV.Bound,
            G6 = SV.G6,
            Vector = SV.Vector;

    </script>
    <script src="./Layouter/LinkList.js"></script>
    <script src="./Layouter/BinaryTree.js"></script>
    <script src="./Layouter/Stack.js"></script>
    <script src="./Layouter/LinkQueue.js"></script>
    <script src="./Layouter/GeneralizedList.js"></script>
    <script src="./Layouter/ChainHashTable.js"></script>
    <script src="./Layouter/Array.js"></script>
    <script src="./Layouter/HashTable.js"></script>
    <script src="./Layouter/LinkStack.js"></script>
    <script src="./Layouter/AdjoinMatrixGraph.js"></script>
    <script src="./Layouter/AdjoinTableGraph.js"></script>
    <script src="./Layouter/SqQueue.js"></script>
    <script src="./Layouter/PTree.js"></script>

    <script>

        let cur = SV(document.getElementById('container'), {
            view: {
                leakAreaHeight: 130,
                groupPadding: 40,
            },
        });


        let data = [{
            Array: {
                data: [
                    { id: 1, data: 1, child: [2, 3], external: 'exx' },
                    { id: 2, data: 2 },
                    { id: 3, data: 3, child: [6, 4] },
                    { id: 4, data: 4 },
                    { id: 6, data: 6 }
                ],
                layouter: 'BinaryTree'
            },
            L: {
                data: [
                    { id: 11, data: 11, next: 22, external: 'tt' },
                    { id: 22, data: 22, next: 33 },
                    { id: 33, data: 33, next: 44 },
                    { id: 44, data: 44, freed: true }
                ],
                layouter: 'LinkList'
            },
            "ChainHashTable": {
                "data": [
                    {
                        "type": "head",
                        "id": "0x618090",
                        "data": "T"
                    },
                    {
                        "type": "node",
                        "id": "0x618030",
                        "data": "N"
                    },
                    {
                        "type": "head",
                        "id": "0x6180f0",
                        "data": "U",
                        "start": "node#0x618030"
                    },
                    {
                        "type": "node",
                        "id": "0x617ff0",
                        "data": "V",
                        "next": "node#0x617fd0"
                    },
                    {
                        "type": "node",
                        "id": "0x617fd0",
                        "data": "A"
                    },
                    {
                        "type": "head",
                        "id": "0x618010",
                        "data": "O",
                        "start": "node#0x617ff0"
                    },
                    {
                        "type": "node",
                        "id": "0x618050",
                        "data": "K"
                    },
                    {
                        "type": "head",
                        "id": "0x6180b0",
                        "data": "R",
                        "start": "node#0x618050"
                    }
                ],
                    "layouter": "ChainHashTable"
            }
        }, {
            Array: {
                data: [
                    { id: 1, data: 1, child: [2, 3], external: 'exx' },
                    { id: 2, data: 2 },
                    { id: 3, data: 3, child: [6, 7] },
                    { id: 7, data: 7 }
                ],
                layouter: 'BinaryTree'
            }
        }];





        let dataIndex = 0,
            curData = data[dataIndex];

        let enableBrushSelect = false;

        const container = document.getElementById('container'),
            pos = document.getElementById('pos');

        const leak = document.getElementById('leak');

        cur.render(curData);

        document.getElementById('btn-next').addEventListener('click', e => {
            curData = data[++dataIndex];
            cur.render(curData);
        });

        document.getElementById('btn-prev').addEventListener('click', e => {
            curData = data[--dataIndex];
            cur.render(curData);
        });

        document.getElementById('resize').addEventListener('click', e => {
            container.style.height = 800 + 'px';
            cur.resize(container.offsetWidth, container.offsetHeight);
        });

        document.getElementById('relayout').addEventListener('click', e => {
            cur.reLayout();
        });

        document.getElementById('switch-mode').addEventListener('click', e => {
            cur.updateStyle('Array', newArrayOption);
        });

        document.getElementById('brush-select').addEventListener('click', e => {
            enableBrushSelect = !enableBrushSelect;
            cur.switchBrushSelect(enableBrushSelect);
        });

        cur.on('onLeakAreaUpdate', payload => {
            leak.style.opacity = payload.hasLeak ? 1 : 0;
            leak.style.top = payload.leakAreaY - 40 + 'px';
        });

        // -------------------------------------------------------------------------------------------------------

        container.addEventListener('mousemove', e => {
            let x = e.offsetX, y = e.offsetY;
            pos.innerHTML = `${x},${y}`;
        });



    </script>
</body>

</html>